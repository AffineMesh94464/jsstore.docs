(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{206:function(n,e,t){"use strict";t.r(e);var o={components:{Layout:t(172).a}},r=t(14),component=Object(r.a)(o,(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("Layout",{attrs:{title:"Migrating from v2 to v3",description:"migrating from v2 to v3",keywords:"migrate, v2, v3, indexeddb, jsstore",contentSrc:"/home/travis/build/ujjwalguptaofficial/jsstore.docs/out/content/tutorial/v3-to-v4.md"}},[t("p",{staticClass:"highlight"},[n._v("\nv4 now suports multiple database feature, which was lacking in earlier version of jsstore. In order to do that some big changes has been done in v4.\n")]),n._v(" "),t("p",[n._v("In order to migrate from v3 to v4 - Increase db version greater than current version. ")]),n._v(" "),t("pre",[t("code",[n._v("var dbSchema = {\n    name:\"Demo\",\n    version: 2 // previous version was 1,\n    tables:[{\n        name:'Products',\n        columns:[{\n            id: {\n                autoIncrement:true,\n                primaryKey:true\n            }\n        }]\n    }]\n}\n\nvar connection = new JsStore.Connection();\nconnection.initDb(dbSchema);\n")])]),n._v(" "),t("p",[n._v("you can find your current db version in indexedDb section of browser development tools.")]),n._v(" "),t("p",[t("img",{staticStyle:{"max-width":"100%"},attrs:{src:"/img/version_screenshot.png"}})]),n._v(" "),t("p",[n._v("ðŸ‘‰ Note:- This step will recreate database & in turn all your data will be cleared. ")]),n._v(" "),t("p",[n._v("If you want to keep your data, you can fetch data before upgrading then insert it after upgrading. In order to do that you will have to keep two db schema.")]),n._v(" "),t("pre",[t("code",[n._v("var dbSchema = {\n    name:\"Demo\",\n    version: 1 ,\n    tables:[{\n        name:'Products',\n        columns:[{\n            id: {\n                autoIncrement:true,\n                primaryKey:true\n            }\n        }]\n    }]\n};\n\nvar newDbSchema = {\n    name:\"Demo\",\n    version: 2 // previous version was 1,\n    tables:[{\n        name:'Products',\n        columns:[{\n            id: {\n                autoIncrement:true,\n                primaryKey:true\n            }\n        }]\n    }]\n}\n\nvar connection = new JsStore.Connection();\nvar isDbCreated = connection.initDb(dbSchema);\n\nvar tablesData = {};\n\n// if db is opened\nif(!isDbCreated){\n\n    // select from table prodcuts\n    const results =  await connection.select({\n        from:'Products'\n    });\n    tablesData['Products'] = results;\n}\n\nisDbCreated = connection.initDb(newDbSchema);\n\nif(isDbCreated){\n    for(const key in tablesData){\n        insert({\n            into:key,\n            values: tablesData[key]\n        })\n    }\n}\n")])])])}),[],!1,null,null,null);e.default=component.exports}}]);